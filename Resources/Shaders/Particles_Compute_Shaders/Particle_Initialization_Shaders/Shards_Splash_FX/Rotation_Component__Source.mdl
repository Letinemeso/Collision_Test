"

layout(std430, binding = 3) buffer Rotation_Buffer
{
    float rotation_data[];      //  vec3
};

uint current_rotation_buffer_offset_index()
{
    return current_particle_index() * 3;
}

float PI = 3.147f;

vec3 calculate_particle_rotation()
{
    vec3 result = vec3(0.0f, 0.0f, 0.0f);

    uint seed = random_number();
    for(uint i = 0; i < 3; ++i)
    {
        result[i] += limit_random_number_float(seed, 0.0f, PI);
        seed = next_random_number(seed);
    }

    return result;
}

void initialize_rotation()
{
    uint index = current_rotation_buffer_offset_index();
    if(index > rotation_data.length())
        return;

    vec3 random_rotation = calculate_particle_rotation();

    rotation_data[index] = random_rotation.x;
    rotation_data[index + 1] = random_rotation.y;
    rotation_data[index + 2] = random_rotation.z;
}

"
