"

layout(std430, binding = 1) buffer Positions_Buffer
{
    float positions_data[];      //  vec3
};

uint current_positions_buffer_offset_index()
{
    return current_particle_index() * 3;
}

layout(std430, binding = 2) buffer velocity_buffer
{
    float velocity_data[];      //  vec3
};

uint current_velocity_buffer_offset_index()
{
    return current_particle_index() * 3;
}


vec3 calculate_coordinate_increment()
{
    uint index = current_velocity_buffer_offset_index();
    if (index >= velocity_data.length())
        return vec3(0.0f, 0.0f, 0.0f);

    return vec3(velocity_data[index], velocity_data[index + 1], velocity_data[index + 2]) * dt;
}

void process_transform()
{
    uint positions_offset_index = current_positions_buffer_offset_index();
    if (positions_offset_index >= positions_data.length())
        return;

    vec3 increment = calculate_coordinate_increment();

    positions_data[positions_offset_index    ] += increment.x;
    positions_data[positions_offset_index + 1] += increment.y;
    positions_data[positions_offset_index + 2] += increment.z;
}

"
